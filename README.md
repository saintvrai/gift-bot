# Gift Bot

Gift Bot - это простой Telegram-бот, предназначенный для отправки поздравлений и сообщений вашим коллегам. Он поддерживает регистрацию пользователей, рассылку сообщений администраторами и управление пользователями.

## Функции

- Регистрация и аутентификация пользователей.
- Функции администратора для отправки сообщений всем пользователям или выбранным пользователям.
- Возможность удаления пользователей из базы данных администраторами.

## Установка

1. Клонируйте репозиторий:

    ```sh
    git clone https://github.com/yourusername/gift-bot.git
    cd gift-bot
    ```

2. Установите зависимости:

    ```sh
    go mod tidy
    ```

3. Настройте бота:

    - Скопируйте `.env.example` в `.env`.
    - Заполните значения в `.env`:
      - `SERVER_GINMODE`, `SERVER_PORT`
      - `PG_HOST`, `PG_PORT`, `PG_USER`, `PG_NAME`, `PG_PASSWORD`, `PG_SSLMODE`
      - `TELEGRAM_HOST`, `TELEGRAM_TOKEN`, `TELEGRAM_SECRET`

4. Настройте базу данных:

    - Запустите миграции базы данных, расположенные в `db/migrations`.

5. Соберите и запустите бота:

    ```sh
    go build -o gift-bot
    ./gift-bot
    ```

## Развертывание через Docker Compose

1. Убедитесь, что у вас установлен Docker и Docker Compose.

2. Убедитесь, что в `.env` заполнены значения:

    - `PG_*` используется и для приложения, и для Docker Compose.
    - `SERVER_*` и `TELEGRAM_*` используются приложением.

3. Запустите Docker Compose:

    ```sh
    docker-compose up -d
    ```

   Это создаст и запустит контейнеры для вашего Telegram-бота и PostgreSQL базы данных.

## Использование

### Команды

#### Для всех пользователей

- **/start**: Зарегистрируйтесь и начните взаимодействие с ботом.

  Бот поприветствует пользователя и предоставит краткое введение.

- **/chat**: Получите ваш уникальный ID чата.

  Бот ответит уникальным ID чата пользователя.

- **/login**: Войдите в бот, используя секретное слово.

  Бот попросит пользователя ввести секретное слово для аутентификации.

#### Для администраторов

- **/message**: Отправьте сообщение всем пользователям.

  Бот попросит администратора ввести сообщение. После этого предоставит список пользователей для исключения из рассылки. После выбора сообщение отправляется всем пользователям, которые не были исключены.

- **/delete**: Удалите пользователей из базы данных.

  Бот попросит администратора ввести логины пользователей, которых нужно удалить, через запятую. Указанные пользователи будут удалены из базы данных.

### Примеры

- **/start**:

    ```
    /start
    ```

  Ответ бота:

    ```
    Привет, <username>! Это простой телеграм бот для поздравляшек своих близких коллег. Тут есть пару команд, чтобы ты мог начать получать сообщения! Если что-то будет не так, то ты всегда можешь написать своему администратору для устранения проблем.
    ```

- **/message**:

    ```
    /message
    ```

  Ответ бота:

    ```
    Введите сообщение, которое хотите отправить всем пользователям:
    ```

  После ввода сообщения:

    ```
    Выберите пользователей, которым не нужно отправлять сообщение. Для отмены введите 'отмена'.
    ```

  Администратор выбирает пользователей для исключения и нажимает "Отправить".

- **/delete**:

    ```
    /delete
    ```

  Ответ бота:

    ```
    Введите логины пользователей через запятую, которых хотите удалить:
    ```

  Администратор вводит логины:

    ```
    <username1>, <username2>
    ```

  Ответ бота:

    ```
    Пользователи успешно удалены.
    ```

Для добавления роли администратора определенному пользователю, необходим доступ до БД и ручками поменять в ней роль пользователя с user на admin.
## Вклад

Если вы хотите внести вклад в этот проект, пожалуйста, откройте pull request или issue на GitHub.

Этот README предоставляет обзор проекта Gift Bot, его функций, инструкции по установке и примеры использования. Это должно помочь вам начать работу с ботом и понять его функциональные возможности.
